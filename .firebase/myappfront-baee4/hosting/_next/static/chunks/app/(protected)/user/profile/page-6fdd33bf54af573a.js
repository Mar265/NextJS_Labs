(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[864],{4003:(e,r,a)=>{Promise.resolve().then(a.bind(a,7050))},7050:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>c});var t=a(5155),s=a(5624),o=a(4565),l=a(7058),i=a(1746),d=a(2115),n=a(6046);let c=()=>{let{user:e,loading:r}=(0,s.A)(),[a,c]=(0,d.useState)(null),[u,m]=(0,d.useState)(""),[p,y]=(0,d.useState)(""),[x,h]=(0,d.useState)(""),[f,g]=(0,d.useState)(""),[w,b]=(0,d.useState)(""),[v,j]=(0,d.useState)(""),[k,N]=(0,d.useState)(""),z=(0,n.useRouter)();(0,d.useEffect)(()=>{let e=(0,o.xI)().currentUser;if(e){if(!e.emailVerified){console.log("Użytkownik niezweryfikowany, przekierowanie do /user/verify"),z.push("/user/verify");return}console.log("Użytkownik zweryfikowany:",e),c(e),m(e.displayName||""),y(e.photoURL||"")}else console.log("Użytkownik niezalogowany, przekierowanie do /user/login"),z.push("/user/login")},[e,z]),(0,d.useEffect)(()=>{(async()=>{if(a)try{let e=(0,l.H9)(i.db,"users",a.uid),r=await (0,l.x7)(e);if(r.exists()){let{address:e}=r.data();h((null==e?void 0:e.city)||""),g((null==e?void 0:e.street)||""),b((null==e?void 0:e.zipCode)||"")}}catch(e){console.error("Błąd podczas pobierania danych adresowych:",e)}})()},[a]);let U=async e=>{e.preventDefault();try{if(!a)throw Error("Brak użytkownika!");await (0,o.r7)(a,{displayName:u,photoURL:p}),await (0,l.BN)((0,l.H9)(i.db,"users",a.uid),{address:{city:x,street:f,zipCode:w}},{merge:!0}),j("Profil został zaktualizowany!"),N("")}catch(e){console.error("Błąd podczas aktualizacji profilu:",e),N("Nie udało się zaktualizować profilu."),j("")}};return r?(0,t.jsx)("div",{className:"h-screen flex items-center justify-center bg-gradient-to-br from-var(--primary-dark) to-var(--primary)",children:(0,t.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Ładowanie danych..."})}):a?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-var(--primary-dark) to-var(--primary)",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-var(--text-main) text-center mb-6",children:"Edytuj Profil"}),k&&(0,t.jsx)("div",{className:"mb-4 bg-red-100 text-red-700 px-4 py-2 rounded-md",children:k}),v&&(0,t.jsx)("div",{className:"mb-4 bg-green-100 text-green-700 px-4 py-2 rounded-md",children:v}),(0,t.jsxs)("form",{onSubmit:U,className:"space-y-6",children:[p&&(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("img",{src:p,alt:"Zdjęcie profilowe",className:"w-32 h-32 rounded-full border-4 border-primary shadow-md"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-var(--text-dark)",children:"Nazwa użytkownika"}),(0,t.jsx)("input",{type:"text",id:"username",value:u,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 mt-1 rounded-md border border-gray-300 focus:ring-2 focus:ring-var(--primary-dark)",placeholder:"Wprowadź nazwę użytkownika"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"photoURL",className:"block text-sm font-medium text-var(--text-dark)",children:"URL zdjęcia profilowego"}),(0,t.jsx)("input",{type:"url",id:"photoURL",value:p,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 mt-1 rounded-md border border-gray-300 focus:ring-2 focus:ring-var(--primary-dark)",placeholder:"Wprowadź URL zdjęcia"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-var(--text-dark)",children:"Miasto"}),(0,t.jsx)("input",{type:"text",id:"city",value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 mt-1 rounded-md border border-gray-300 focus:ring-2 focus:ring-var(--primary-dark)",placeholder:"Wprowadź miasto"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"street",className:"block text-sm font-medium text-var(--text-dark)",children:"Ulica"}),(0,t.jsx)("input",{type:"text",id:"street",value:f,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 mt-1 rounded-md border border-gray-300 focus:ring-2 focus:ring-var(--primary-dark)",placeholder:"Wprowadź ulicę"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"zipCode",className:"block text-sm font-medium text-var(--text-dark)",children:"Kod pocztowy"}),(0,t.jsx)("input",{type:"text",id:"zipCode",value:w,onChange:e=>{let r=e.target.value.replace(/[^0-9]/g,"");r.length<=5&&b(r.length>2?"".concat(r.slice(0,2),"-").concat(r.slice(2)):r)},className:"w-full px-4 py-2 mt-1 rounded-md border border-gray-300 focus:ring-2 focus:ring-var(--primary-dark)",placeholder:"32-000"})]}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-var(--primary) text-white py-2 rounded-md hover:bg-var(--primary-dark)",children:"Zapisz zmiany"})]})]})}):(0,t.jsx)("div",{className:"h-screen flex items-center justify-center bg-gradient-to-br from-var(--primary-dark) to-var(--primary)",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-var(--text-main) text-center mb-6",children:"Nie jesteś zalogowany"}),(0,t.jsx)("button",{onClick:()=>z.push("/user/login"),className:"w-full bg-var(--primary) text-white py-2 rounded-md hover:bg-var(--primary-dark)",children:"Przejdź do logowania"})]})})}},5624:(e,r,a)=>{"use strict";a.d(r,{A:()=>c,AuthProvider:()=>n});var t=a(5155),s=a(2115),o=a(6046),l=a(4565),i=a(1746);let d=(0,s.createContext)(),n=e=>{let{children:r}=e,[a,n]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0),m=(0,o.useRouter)();(0,s.useEffect)(()=>{let e=(0,l.hg)(i.j,e=>{e?n({uid:e.uid,email:e.email,displayName:e.displayName||"",photoURL:e.photoURL||"",emailVerified:e.emailVerified}):n(null),u(!1)});return()=>e()},[]);let p=async()=>{try{await (0,l.CI)(i.j),n(null),console.log("Pomyślnie wylogowano."),m.push("/")}catch(e){console.error("Błąd podczas wylogowywania:",e)}},y=async()=>{try{i.j.currentUser&&!i.j.currentUser.emailVerified?(await (0,l.gA)(i.j.currentUser),console.log("E-mail weryfikacyjny został wysłany ponownie.")):console.log("E-mail już zweryfikowany.")}catch(e){console.error("Błąd podczas wysyłania e-maila weryfikacyjnego:",e)}};return(0,t.jsx)(d.Provider,{value:{user:a,loading:c,logout:p,resendVerificationEmail:y},children:r})},c=()=>(0,s.useContext)(d)},1746:(e,r,a)=>{"use strict";a.d(r,{db:()=>d,j:()=>i});var t=a(9904),s=a(4565),o=a(7058);let l=(0,t.Wp)({apiKey:"AIzaSyBdyYyVmrb1sNxMlIFnjG8U5wJsNYfc6QY",authDomain:"myappfront-baee4.firebaseapp.com",projectId:"myappfront-baee4",storageBucket:"myappfront-baee4.appspot.com",messagingSenderId:"393811731877",appId:"1:393811731877:web:9fe423b0b66309e9b7f44c",measurementId:"G-XWYY0W89KS"});window.firebaseLogLevel="silent";let i=(0,s.xI)(l),d=(0,o.aU)(l)},6046:(e,r,a)=>{"use strict";var t=a(6658);a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})}},e=>{var r=r=>e(e.s=r);e.O(0,[992,782,861,441,517,358],()=>r(4003)),_N_E=e.O()}]);